from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from pydantic import BaseModel
import joblib
import pandas as pd
import numpy as np
import asyncio
#from douane_feat import COD_BANQUE, CODE_DECLARANT, CODE_NATURE_COLIS, CODE_OPERATEUR, CODE_PORT_CHARG, IDEN_MOY_TRANSP_ARRIVE, PROVENANCE

# Set up constants
CODE_DECLARANT = [
    '00045G', '00069Z', '00074L', '00085W', '00100R', '00106T', '00109N', '00114G', '00119E', '00167A', 
    '00169R', '00179F', '00182S', '00196M', '00197C', '00200W', '00210Q', '00214K', '00218Y', '00220C', 
    '00228S', '00230Z', '00233Q', '00238R', '00250P', '00251S', '00256Q', '00258L', '00271F', '00272X', 
    '00277D', '00278J', '00281L', '00284R', '00285B', '00286V', '00287Y', '00288M', '00295X', '00296P', 
    '00300D', '00304L', '00306K', '00309V', '00312C', '00313T', '00314H', '00316N', '00317F', '00318X', 
    '00326E', '00327L', '00340F', '00342P', '00344G', '00348Q', '00353R', '00355V', '00357M', '00359T', 
    '00360H', '00361W', '00362N', '00363F', '00367G', '00368Z', '00370J', '00374A', '00377B', '00378V', 
    '00380M', '00383H', '00384W', '00385N', '00391Z', '00393J', '00394Q', '00400B', '00402Y', '00406H', 
    '00407W', '00410X', '00411P', '00412S', '00414Z', '00416J', '00422R', '00424J', '00427H', '00430Z', 
    '00434L', '00435Q', '00436R', '00437X', '00438P', '00441P', '00443B', '00444A', '00445C', '00448E', 
    '00450H', '00451J', '00452K', '00453L', '00454M', '00455P', '00457Q', '00459V', '00460S', '00461T', 
    '00463W', '00464X', '00466Z', '00468B', '00470D', '00471E', '00473F', '00475W', '00476X', '00477Y', 
    '00478Z', '00480D', '00482E', '00483F', '00485H', '00486J', '00488L', '00491P', '00495T', '00500Y', 
    '00502A', '00503B', '00508G', '00511K', 'P1309S', 'P1503K', 'P1703N', 'P1708T', 'P1709Y', 'P1804M', 
    'P1806M', 'P1807U', 'P1901F', 'P1903G', 'P2001H', 'P2003J', 'P2104F', 'P2201G'
    ]

CODE_OPERATEUR = ['0020634C', '0025697V', '0041924Y', '0045579J', '0100541M', '0100708D', '0100717M', '0100756U', '0100758E', '0100984A', '0101154E', '0101168L', '0171312H', '0179308E', '0196371E', '0204262Z', '0204336K', '0208793S', '0213753M', '0214956A', '0217126V', '0217189D', '0223581U', '0231310P', '0301065Q', '0305312Q', '0309330A', '0310771U', '0311172H', '0314246N', '0319150X', '0332649U', '0406131Z', '0407056A', '0407153G', '0409567R', '0409942R', '0413997L', '0418417T', '0423658R', '0505793C', '0509562Q', '0511168E', '0517069C', '0518626G', '0521319F', '0524160F', '0531109G', '0542010E', '0542042A', '0552517V', '0604882H', '0607194A', '0647432F', '0666923E', '0696171B', '0701933C', '0702901N', '0704149V', '0708142S', '0712317C', '0715379V', '0720164P', '0732031V', '0804217E', '0804712E', '0809132E', '0813628A', '0816018V', '0819003A', '0822992R', '0823450E', '0900051P', '0901305Q', '0906091S', '0908308A', '0908612J', '0909042K', '0915085L', '0915319A', '0918898B', '1006737X', '1013503L', '1013740C', '1015768E', '1018182P', '1020180X', '1020830S', '1021024E', '1021697N', '1100695D', '1101212V', '1103255A', '1105242F', '1105624W', '1108405F', '1109022S', '1109781H', '1202158L', '1202766M', '1204740Z', '1214924P', '1218180E', '1221928S', '1223938W', '1245123T', '1252090H', '1256052A', '1264168K', '1285255G', '1290873D', '1292857T', '1300612R', '1302859P', '1304631C', '1305364R', '1311655A', '1312843Y', '1315298H', '1317341D', '1317518X', '1320894Y', '1321829T', '1322570C', '1327850A', '1329541A', '1330129A', '1331981N', '1334281T', '1334291V', '1340115E', '1341211B', '1343430D', '1343443E', '1343757Q', '1343958J', '1345523Y', '1347386H', '1349636M', '1351498E', '1353673N', '1353875H', '1354763R', '1388016W', '1400218K', '1400688K', '1401318C', '1401664F', '1405989S', '1406080T', '1406500D', '1406510W', '1406511K', '1406698F', '1407155X', '1407920S', '1409043C', '1410168A', '1411239W', '1416993G', '1417233N', '1418131R', '1419455X', '1419759P', '1420732Z', '1424510P', '1426001K', '1427735P', '1428321Z', '1431442N', '1431541R', '1432052K', '1432656V', '1433678C', '1434049S', '1434225P', '1435854P', '1435882C', '1436749E', '1438518Z', '1441820X', '1442308K', '1444068F', '1444199Y', '1445276D', '1447223S', '1501432K', '1502470E', '1504393X', '1504895P', '1506345G', '1507649J', '1508083Y', '1508593U', '1509839B', '1510786S', '1514857R', '1518419W', '1518887L', '1522220W', '1528074Z', '1528567U', '1530321T', '1531062Q', '1533188N', '1534033E', '1535595G', '1535764Y', '1536337M', '1538587K', '1540783D', '1540956A', '1541973Y', '1542284X', '1542477Y', '1542957Z', '1545636S', '1547607G', '1548237D', '1548440M', '1551109H', '1551365G', '1554003V', '1554236S', '1555415P', '1557126P', '1600500T', '1600524E', '1602374M', '1603153H', '1603869P', '1604038A', '1604529B', '1604537T', '1609791P', '1610407B', '1610553C', '1611394S', '1611783Y', '1611849A', '1613999T', '1614071U', '1615981K', '1617859A', '1619663P', '1619682B', '1620067A', '1621348M', '1621558G', '1623312T', '1623468G', '1624560H', '1626708L', '1627872Z', '1628761J', '1629945C', '1631732Y', '1632538X', '1633359L', '1633548A', '1633939S', '1633958D', '1634232W', '1634513Q', '1638418D', '1638927T', '1639814T', '1640404N', '1641273N', '1641409Q', '1643232F', '1644083X', '1648473N', '1650889N', '1652750T', '1653041D', '1655080B', '1655535T', '1656431U', '1657937Y', '1658629U', '1659065K', '1660027A', '1701421Y', '1702431T', '1702504D', '1703365R', '1705485V', '1707762K', '1709238Y', '1709395N', '1709453Q', '1709544K', '1709845R', '1709851P', '1710488G', '1712568D', '1717180S', '1718461G', '1718980D', '1721232V', '1721439V', '1722037N', '1725004Z', '1726443W', '1728075A', '1728412Z', '1729194Y', '1730587X', '1732163T', '1733813Q', '1734273B', '1736949B', '1739623F', '1739738J', '1741007C', '1742834W', '1743143A', '1743558J', '1743742J', '1744027S', '1744337D', '1744756R', '1744816W', '1744984X', '1745185X', '1745930D', '1748713J', '1750125B', '1750432F', '1751650S', '1752130A', '1752376L', '1753149J', '1800818E', '1801079H', '1801139S', '1801745H', '1801802U', '1802114J', '1802163T', '1803137J', '1803485Q', '1803683W', '1806524R', '1807106Y', '1807184N', '1807202G', '1807223U', '1808131Z', '1808247M', '1809634A', '1811649A', '1813348E', '1814073P', '1814334R', '1814680Z', '1814879U', '1815644Z', '1816040U', '1816498R', '1816688X', '1817575N', '1817613L', '1818596M', '1820804U', '1821015C', '1821193C', '1821896D', '1821974J', '1823203Y', '1823771Y', '1825071Q', '1825593H', '1825982F', '1826188L', '1827772V', '1827784J', '1828308N', '1828558G', '1830288G', '1830882L', '1831452R', '1831573J', '1832258F', '1833500Y', '1833761Y', '1834388U', '1834456Q', '1834465R', '1836019P', '1836020L', '1837236N', '1839793X', '1839908B', '1840412W', '1840974H', '1841552X', '1842269L', '1846195P', '1849039G', '1851347B', '1853349P', '1854450A', '1856859A', '1857008A', '1858243J', '1859894Z', '1859987W', '1860244R', '1864638C', '1865091M', '1865659J', '1867007T', '1868878R', '1869721C', '1869813Z', '1869975B', '1900287E', '1901262H', '1901539X', '1902675G', '1903387Z', '1904193Q', '1904923K', '1905085Q', '1906099X', '1906786U', '1906957X', '1908397G', '1909670W', '1911686L', '1912449X', '1913218Y', '1913421C', '1913530M', '1914891D', '1915780S', '1916006K', '1916174P', '1917564P', '1917889N', '1917973R', '1918056W', '1918535K', '1918707G', '1918760Q', '1919283Y', '1919299G', '1920515M', '1920845Y', '1920906W', '1921034B', '1921188K', '1921426H', '1921956L', '1922675T', '1922831G', '1923121H', '1923294P', '1923296R', '1923552R', '1923604W', '1923938L', '1924334P', '1924567R', '1925124E', '1925553L', '1925999L', '1926370H', '1926580M', '1926633M', '1926712L', '1926775T', '1927031E', '1927849X', '1927933B', '1929077W', '1929104X', '1933125F', '1933165P', '1934481E', '1935897G', '1936618Y', '1937986B', '1938038Y', '1940841G', '1942335S', '1942541Z', '1942718A', '1943005V', '1943171X', '1943425N', '1944701C', '1945014P', '1945107S', '1945684U', '1945962S', '1947109E', '1947297S', '1949388P', '1950500R', '1950961A', '1951097R', '1951150E', '1951200R', '1951366A', '1951990Z', '1952628A', '1956139U', '1960921U', '1963099X', '1964270K', '1967456V', '1973005T', '1973006U', '1978366M', '1978877E', '1979579L', '1979675L', '1982325R', '1983442Q', '1987310T', '1989104U', '1991055P', '1992390Z', '1996793M', '2001971W', '2002214Y', '2003017P', '2005614U', '2006145X', '2006368N', '2006490W', '2006588U', '2006655E', '2006830S', '2007147S', '2007526N', '2008095T', '2008323B', '2008523U', '2008937T', '2009136Z', '2009199H', '2009427V', '2010471V', '2010569F', '2012193D', '2012850T', '2013300D', '2013791M', '2014146P', '2014433F', '2015033A', '2015155R', '2015604U', '2016059V', '2016121G', '2016228T', '2016564L', '2017545J', '2017961K', '2017989Q', '2018068G', '2018105T', '2018270K', '2018910V', '2019156W', '2019278Q', '2020408H', '2020645D', '2020688H', '2021695M', '2022685L', '2023223M', '2023546R', '2023910J', '2024518N', '2025229V', '2025684N', '2025711Q', '2026034E', '2026300A', '2027414H', '2027997A', '2028552U', '2028572Y', '2029296V', '2029659Q', '2029753E', '2030899X', '2032170V', '2032445M', '2032535F', '2032823G', '2033069Y', '2033350A', '2033451L', '2033611L', '2034312R', '2034922D', '2036062L', '2036142R', '2036725R', '2037299Y', '2037595H', '2038441X', '2038500F', '2038949C', '2039594J', '2039939T', '2041121R', '2041858C', '2042070E', '2043018X', '2043669Q', '2044036J', '2044356F', '2044685S', '2045398B', '2045689F', '2046633X', '2046732S', '2046795S', '2046847W', '2047516K', '2047602A', '2047616X', '2049071A', '2049347K', '2049654P', '2049741N', '2049768Z', '2050129E', '2050189B', '2050198C', '2050227G', '2050740W', '2051274C', '2051611W', '2051908H', '2051945V', '2051952U', '2052433M', '2053245H', '2054480T', '2054915J', '2055001T', '2100153E', '2101061S', '2101545U', '2103194P', '2104252H', '2105452T', '2106362H', '2107178A', '2107534P', '2108312H', '2109405H', '2110046X', '2111948Z', '2112541J', '2113405L', '2114027C', '2114679E', '2114866J', '2115069X', '2116722K', '2117333N', '2118211V', '2118480Y', '2121135C', '2122117B', '2122238U', '2125101P', '2128225V', '2128249M', '2132883E', '2134248A', '2135573R', '2135580M', '2135795Q', '2137259G', '2138551W', '2141032L', '2141878H', '2141928T', '2142283W', '2144425N', '2144907S', '2145015P', '2145798D', '2145877U', '2147871Y', '2148250W', '2148486Y', '2149584T', '2151802Y', '2155257G', '2155271E', '2156439Y', '2156481K', '2156517N', '2157082P', '2157962V', '2159351J', '2160490G', '2161735V', '2161790H', '2163219A', '2163643B', '2163688H', '2164845X', '2165287Z', '2166581R', '2166583K', '2167579F', '2167697W', '2168967D', '2169104E', '2169325A', '2170933Z', '2174857V', '2176842Y', '2177319C', '2177479D', '2181836G', '2182376T', '2182899R', '2185784Q', '2188921L', '2189526R', '2189684Y', '2191554P', '2194050Y', '2195274S', '2195612M', '2196709G', '2201065A', '2202423X', '2202483U', '2203599H', '2208282Q', '2208672W', '2210317F', '2210932Y', '2212238E', '2212821P', '2212827M', '2213015K', '2214582J', '2215123N', '2216548H', '2217782V', '2219556C', '2227098V', '2230089B', '2230212A', '2231273C', '2233072Y', '2233509C', '2236802V', '2236939V', '2239132X', '2239417V', '2239870P', '2242040G', '2242078B', '2242164S', '2242374R', '2242399P', '2242463K', '2242587W', '2242634V', '2242741W', '2242747L', '2242888V', '2243007S', '2243009E', '2243209N', '2243311S', '2243327U', '2243329M', '2243371E', '2243492Y', '2243516J', '2244150B', '2244231X', '2244401L', '2244454Z', '2244624X', '2244813F', '2244821M', '2245227N', '2245253K', '2300145E', '2300255B', '2300443D', '2300448K', '2300520B', '2300869K', '2301100S', '2301265Y', '2301342F', '2301364P', '2301576H', '2301665J', '2301666E', '2301756U', '2302386U', '2302809C', '2302939S', '2303168U', '2303309X', '2304288U', '2304467L', '2305336Y', '4105730F', '4106231Y', '4107727S', '4116232J', '4215948B', '4224953Z', '4233677D', '4259718Y', '4259950V', '4268307W', '4268805J', '4273151E', '4273616G', '5006001W', '5007123M', '5011806N', '5012050X', '6000427U', '6900765R', '7204606N', '7400363J', '7401730B', '7603129F', '7901605G', '8100123E', '8204214M', '8303674V', '8400582G', '8503417V', '8700667G', '8702809W', '8800004R', '8800453P', '8803233H', '8804981Z', '8806668Y', '9000373Y', '9000473M', '9000577M', '9000831C', '9004996S', '9104617E', '9201080M', '9201982E', '9206309G', '9403041C', '9415682X', '9501007D', '9501016V', '9502090D', '9509439J', '9603839R', '9603946L', '9604087C', '9606123E', '9614475E', '9702458W', '9708745B', '9709432K', '9711961E', '9725254P', '9801937S', '9809785J', '9815019S', '9818812V', '9818944H', '9901911U', '9904279V', '9910169Q', '9912770L']

PROVENANCE = ['99', 'AE', 'AR', 'AU', 'BE', 'BF', 'BJ', 'BR', 'BS', 'CA', 'CG', 'CM', 'CN', 'CO', 'CY', 
              'DE', 'DK', 'DZ', 'EE', 'EG', 'ES', 'FR', 'GB', 'GH', 'GN', 'GR', 'ID', 'IN', 'IR', 'IT', 
              'JP', 'KR', 'KW', 'LB', 'LT', 'LV', 'MA', 'ME', 'MT', 'MX', 'MY', 'NG', 'NL', 'PA', 'PL', 
              'PT', 'PY', 'RO', 'SA', 'SE', 'SG', 'SI', 'SN', 'TG', 'TH', 'TN', 'TR', 'TW', 'UA', 'US', 
              'UY', 'VE', 'VN', 'ZA'
              ]

CODE_NATURE_COLIS = ['BB', 'BE', 'BG', 'BL', 'BT', 'BX', 'CA', 'CL', 'CR', 'CS', 'CT', 'DR', 'FE', 'FR', 
                     'FT', 'KG', 'LO', 'LT', 'NE', 'OK', 'PC', 'PE', 'PK', 'PL', 'PP', 'PR', 'PU', 'RO', 
                     'SA', 'UN', 'VL', 'VO', 'VR'
                     ]

CODE_PORT_CHARG = ['00ANR', 'AEJEA', 'ARBUE', 'AUBNE', 'AUMEL', 'BEANR', 'BFBOY', 'BFOUA', 'BJCOO', 
                   'BRIOA', 'BRITJ', 'BRNVT', 'BRPNG', 'BRRIG', 'BRSSZ', 'BSNAS', 'CAMTR', 'CASJB', 
                   'CAVAN', 'CGPNR', 'CMDLA', 'CMKBI', 'CNDLC', 'CNFOC', 'CNHUA', 'CNLKU', 'CNLYG', 
                   'CNNBO', 'CNNGB', 'CNNSA', 'CNSHA', 'CNSHK', 'CNSWA', 'CNTAO', 'CNTSN', 'CNTXG', 
                   'CNWHI', 'CNXGG', 'CNXMN', 'CNYTN', 'CNZOS', 'COCTG', 'CYLMS', 'DEBRV', 'DEHAM', 
                   'DEWVN', 'DEXTE', 'DKAAR', 'DKCPH', 'DKFRC', 'DZDJE', 'EETLL', 'EGALY', 'EGEDK', 
                   'EGPSD', 'ESALC', 'ESALG', 'ESBCN', 'ESBIO', 'ESCAD', 'ESCAS', 'ESGIJ', 'ESLAG', 
                   'ESMAR', 'ESVGO', 'ESVLC', 'FRDKK', 'FRFOS', 'FRLEH', 'FRMRS', 'FRMTX', 'FRPOV', 
                   'FRSET', 'FRURO', 'GBBEL', 'GBFXT', 'GBLGP', 'GBLIV', 'GBLON', 'GBPME', 'GBSHS', 
                   'GBSOU', 'GBTIL', 'GHTEM', 'GNCKY', 'GRSKG', 'IDJKT', 'IDSUB', 'INCCU', 'INHZR', 
                   'INKAK', 'INKRI', 'INMUM', 'INMUN', 'INNSA', 'INTUT', 'INVTZ', 'IRBND', 'ITAOI', 
                   'ITBRI', 'ITGOA', 'ITLIV', 'ITNAP', 'ITRAN', 'ITSAL', 'ITVCE', 'ITVDL', 'ITVTI', 
                   'JPTYO', 'KRICH', 'KWSAA', 'LBBEY', 'LTKLJ', 'LVRIX', 'MAAGA', 'MACAS', 'MAPTM', 
                   'MATNG', 'MEBAR', 'MTMLA', 'MXATM', 'MXPGO', 'MXZLO', 'MYTPP', 'NGAPP', 'NGLOS', 
                   'NLAMS', 'NLRTM', 'NLVLI', 'PAGDE', 'PLGDA', 'PLGDN', 'PLGDY', 'PTLEI', 'PTSIE', 
                   'PYBCM', 'ROCND', 'SAJUB', 'SEGOT', 'SGSIN', 'SIKOP', 'SNDKR', 'TGLFW', 'THKSI', 
                   'THLCH', 'TNSFA', 'TNTUN', 'TRALI', 'TRAMB', 'TRAMR', 'TRGEB', 'TRGEM', 'TRISK', 
                   'TRIST', 'TRKCO', 'TRMAR', 'TRMER', 'TRSSX', 'TRTEK', 'TWTXG', 'UAODS', 'UAYUZ', 
                   'USCHS', 'USCST', 'USHOU', 'USMVE', 'USNEK', 'USNYC', 'USSAV', 'UYMVD', 'VEVLN', 
                   'VNHPH', 'VNVIC', 'VNVUT', 'ZACPT', 'ZADUR', 'ZZZZZ'
                   ]

IDEN_MOY_TRANSP_ARRIVE = ['11JM6233', 'A LA MARINE', 'ABIDJAN EXPRESS', 'ABIDJANH EXPRESS', 'ADELHEID-S', 'ADILIA I', 'AE VENUS', 'AILA', 'AL DAHNA EXPRESS', 'AL NEFUD', 'AL ZUBARA', 'ALANA', 'ALEXANDRA', 'ALEXANDRIA BRIDGE', 'ALEXIS', 'ALINDA', 'ALS CERES', 'ALS CLIVIA', 'ALS FIDES', 'ALS JUPITER', 'ALS KRONOS', 'ALS SUMIRE', 'AMALTHEA', 'AMERICA', 'ANABIESETAS', 'ANDROUSA', 'ANL  WYONG', 'ANL WANGARATTA', 'ANL WYONG', 'ANNABA', 'ANO KATO', 'ANTON SCHULTE', 'ANTWERP BRIDGE', 'APL  HOLLAND', 'APL ATLANTA', 'APL BARCELONA', 'APL CAIRO', 'APL CENTERM', 'APL CHANGI', 'APL CHONGQING', 'APL DETROIT', 'APL HOLLAND', 'APL HOLLANDF', 'APL HOUSTON', 'APL JEDDAH', 'APL MEXICO CITY', 'APL QINGDAO', 'APL SALALAH', 'APL SANTIAGO', 'APL VANCOUVER', 'APL VANDA', 'APLHOLLAND', 'AQUARIUS HONOR', 'ARABIAN SEA', 'ARGOLIGOS', 'ARGOLIKOS', 'ARGORIKOS', 'ARIES J', 'AS ANITA', 'AS EMMA', 'AS NINA', 'AS PALINA', 'AS SELINA', 'AS SVENJA', 'ASIAN ANTERPRISE', 'ASIAN PEARL', 'ASSELINA', 'ASTRORUNNER', 'ATHENS GLORY V', 'ATLANTIC DISCOVERER', 'ATLANTIC GENEVA', 'ATLANTIC SEA', 'ATLANTIC WEST', 'AVA D', 'AVILA', 'BAHAMAS', 'BALTIC  SPIRIT', 'BALTIC NORTH', 'BALTIC SOUTH', 'BALTIC SPIRIT', 'BALTIC WEST', 'BALTIMORE STAR', 'BARCELONA  EXPRESS', 'BARCELONA EXPRESS', 'BARRY', 'BASLE EXPRESS', 'BEATE', 'BEATE MARTHA A', 'BELITAKI', 'BELTIDE', 'BF CARODA', 'BG DIAMOND', 'BG JADE', 'BG ONYX', 'BOCS VISION', 'BOMAR  RENAISSANCE', 'BOMAR JULIANA', 'BOMAR SPRING', 'BREMEN', 'BREMEN BELLE', 'BREMEN EXPRESS', 'BRIDGE', 'BSG BONAIRE', 'BUDAPEST BRIDGE', 'BUDAPEST EXPRESS', 'BURGUNDY', 'BUXCLIFF', 'BUXCONTACT', 'CALLAO EXPRESS', 'CALYPSO', 'CAP JERVIS', 'CAP SAN  RAPHAEL', 'CAP SAN ANTONIO', 'CAP SAN ARTEMISSIO', 'CAP SAN AUGUSTIN', 'CAP SAN JUAN', 'CAP SAN LAZARO', 'CAP SAN LORENZO', 'CAP SAN MALEAS', 'CAP SAN MALES', 'CAP SAN MARCO', 'CAP SAN RAPHAEL', 'CAP SAN SOUNIO', 'CAP SAN TAINARO', 'CAPE CITIUS', 'CAPE CITUS', 'CAPE KORTIA', 'CAPE MALE', 'CAPE MOSS', 'CARIBBEAN STAR', 'CARTAGENA TRADER', 'CBCL EAST CHINA SEA', 'CELSIUS LIVERPOOL', 'CELSUS LONDON', 'CHICAGO EXPRESS', 'CHOPIN', 'CHRISTA SCHULTE', 'CHRISTAL SCHULTE', 'CIELO  DI  RABAT', 'CINDY', 'CINTAINERSHIPS ARCTIC', 'CLAIRE A', 'CMA  CGM  AMBER', 'CMA  CGM  SAVANNAH', 'CMA  CGM  VERDI', 'CMA  CGM SAVANNAH', 'CMA CGM  AFRICA THREE', 'CMA CGM  KRIBI', 'CMA CGM  ROSSINI', 'CMA CGM AFRICA ONE', 'CMA CGM AFRICA THREE', 'CMA CGM AFRICA TWO', 'CMA CGM AGADIR', 'CMA CGM ALCAZAR', 'CMA CGM ALGECIRAS', 'CMA CGM ALIAGA', 'CMA CGM AMBARLI', 'CMA CGM AMBER', 'CMA CGM AMERICA', 'CMA CGM BARRACUDA', 'CMA CGM BOUGAINVILLE', 'CMA CGM CAYENNE', 'CMA CGM CENDRILLON', 'CMA CGM CHIWAN', 'CMA CGM CORAL', 'CMA CGM DALILA', 'CMA CGM DUTCH HARBOR', 'CMA CGM ESTELLE', 'CMA CGM FIDELIO', 'CMA CGM FORT ST LOUIS', 'CMA CGM G. WASHINGTON', 'CMA CGM HOMERE', 'CMA CGM ISKENDERUN', 'CMA CGM JACQUES JOSEPH', 'CMA CGM JASPER', 'CMA CGM KRIBI', 'CMA CGM LAMARTINE', 'CMA CGM LAPIS', 'CMA CGM LEKKI', 'CMA CGM LEO', 'CMA CGM LOME', 'CMA CGM LOUGA', 'CMA CGM LOUIS BLERIOT', 'CMA CGM MAGDALENA', 'CMA CGM MANAUS', 'CMA CGM MASAI MARA', 'CMA CGM MAUPASSANT', 'CMA CGM MEDEA', 'CMA CGM MEKONG', 'CMA CGM MELISANDE', 'CMA CGM MOLIERE', 'CMA CGM MONTOIR', 'CMA CGM MONTREAL', 'CMA CGM MOZART', 'CMA CGM MUSSET', 'CMA CGM NERVAL', 'CMA CGM NEVA', 'CMA CGM OPAL', 'CMA CGM OSAKA', 'CMA CGM RABELAIS', 'CMA CGM RHONE', 'CMA CGM RIMBAUD', 'CMA CGM ROSSINI', 'CMA CGM SAMBHAR', 'CMA CGM SAVANNAH', 'CMA CGM SINNAMARY', 'CMA CGM TARPON', 'CMA CGM TARRAGONA', 'CMA CGM TITAN', 'CMA CGM TOPAZ', 'CMA CGM TURQUOISE', 'CMA CGM VERDI', 'CMA CGM VILA DO CONDE', 'CMA CGM VOLTAIRE', 'CMA CGM WHITE SHARK', 'CNC NEPTUNE', 'COLOMBIAN STAR', 'COLOMBO', 'COLOMBO EXPRESS', 'CONESTE', 'CONSTANTINOS P II', 'CONSTSHIP ZEN', 'CONTACT', 'CONTAINER SHIPS ARCTIC', 'CONTAINERSHIPS ARCTIC', 'CONTAINERSHIPS ARTIC', 'CONTAINERSHIPS AURORA', 'CONTAINERSHIPS POLAR', 'CONTI CHIVALRY', 'CONTI CORTESIA', 'CONTI COURAGE', 'CONTI DARWIN', 'CONTI EVEREST', 'CONTSHIP ANA', 'CONTSHIP IVY', 'CONTSHIP RAY', 'CONTSHIP TOP', 'CONTSHIP VOW', 'CONTSHIP ZEN', 'CORCOVADO', 'CORCOVADO III', 'COSCO  YINGKOU', 'COSCO AQARA', 'COSCO FUKUYAMA', 'COSCO FUZHOU', 'COSCO GLORY', 'COSCO JAPAN', 'COSCO KAWASAKI', 'COSCO SHIPPING LEO', 'COSCO SHIPPING LIBRA', 'COSCO SHIPPING TAURUS', 'COSCO VIETNAM', 'COSCO YINGKOU', 'COSTA RICAN STAR', "COTE D'IVOIRIAN STAR", 'CRYSTAL RAY', 'CS  SERVICE', 'CS BEST', 'CS QUALITY', 'CS SERVICE', 'CSAV TRAIGUEN', 'CSCL BOHAI SEA', 'CSCL MERCURY', 'CSCL MONTEVIDEO', 'CSCL NEPTUNE', 'CT DANIEL', 'CT PACHUCA', 'CZECH', 'DA XIN 7', 'DACHAN BAY EXPRES', 'DACHAN BAY EXPRESS', 'DALLAS EXPRESS', 'DANU BHUM', 'DERBY D', 'DETROIT EXPRESS', 'DIAMOND STAR I', 'DINA TRADER', 'DIONYSSIS  A', 'DIONYSSIS A', 'DS KOI', 'DUESSELDORF EXPRESS', 'DUMMY BARGE', 'DYROS', 'EBBA MAERSK', 'EDISON', 'EF OLIVIA', 'ELBCARRIER', 'ELBFEEDER', 'ELBSPIRIT', 'ELBSUN', 'ELBWATER', 'ELEGANT ACE', 'ELEN T', 'ELENI T', 'ELEONORA MAERSK', 'ELIZABETH', 'ELLY MAERSK', 'EM HYDRA', 'EM KEA', 'EMMA MAERSK', 'EMOTION', 'EMPIRE', 'ENDURANCE', 'ENFORCER', 'ENSENADA', 'ENSENDA', 'ERVING', 'ESPERANCE', 'ESPOIR', 'ESPOIR TSINGTAO EXPRESS', 'ESTELLE MAERSK', 'EUGEN MAERSK', 'EUROCARGO CAGLIARI', 'EUROPE-MF051W', 'EVELYN MAERSK', 'EVER LINKING', 'EVER UNICORN', 'EVER UNITY', 'EXPRESS ARGENTINA', 'EXPRESS BLACK SEA', 'EXPRESS SPAIN', 'FAN ZHOU 23', 'FANG ZHOU', 'FENJA', 'FIONA', 'FLORIDA  BAY', 'FLORIDA BAY', 'FOLEGANDROS', 'FREDERIK', 'FRISIA OLSO', 'FRISIA OSLO', 'FU LI 318', 'GARFIELD', 'GENOA EXPRESS', 'GEORGIA TRADER', 'GESINA SCHEPERS', 'GFS  GENESIS', 'GFS GENESIS', 'GFS JADE', 'GH MAESTRO', 'GH SCIROCCO', 'GLASGOW EXPRESS', 'GLOVIS CORONA', 'GLOVIS COSMOS', 'GLOVIS COUGAR', 'GLOVIS CROWN', 'GLOVIS SAFETY', 'GRANDE  BRASILE', 'GRANDE  BUENOS AIRES', 'GRANDE  CONGO', 'GRANDE ABIDJAN', 'GRANDE ANGOLA', 'GRANDE BENIN', 'GRANDE BRASILE', 'GRANDE CAMEROON', 'GRANDE CONGO', 'GRANDE CONTONOU', 'GRANDE COSTA D AVORIO', "GRANDE COSTA D'AVORIO", 'GRANDE COTONOU', 'GRANDE DAKAR', 'GRANDE GHANA', 'GRANDE LAGOS', 'GRANDE LUANDA', 'GRANDE MAROCCO', 'GRANDE SAPPHIRE', 'GRANDE SIERRA LEONNE', 'GRANDE TEMA', "GSL CHATEAU D'IF", 'GSL LALO', 'GSL MELINA', 'GSL SUSAN', 'GSL SYROS', 'GSL VINIA', 'GSS YANGON', 'GUANG XING 598', 'GUARAN F 502', 'GULBENIZ A', 'GURAN F 503', 'HAI BANG DA 298', 'HALLEY', 'HAMMONIA  BALTICA', 'HAMMONIA AMERICA', 'HAMMONIA BALTICA', 'HAMMONIA PALATIUM', 'HANS SCHULTE', 'HANSA COLOMBO', 'HANSA EUROPE', 'HANSA NEUBURG', 'HANSA SIEGBURG', 'HARPY HUNTER', 'HEDWIG SCHULTE', 'HELMUT', 'HENRIKA SCHULTE', 'HM STOCKHOLM', 'HMM  OSLO', 'HMM ALGECIRAS', 'HMM DUBLIN', 'HMM HELSINKI', 'HMM OSLO', 'HONG TAI', 'HSL PORTSMOUTH', 'HSL PORTSMOUTHA', 'HUA XIN CHANG HE', 'HUNGARY', 'HUTTON', 'HYPERION RAY', 'HYUNDAI TACOMA', 'IAN H', 'IONIC', 'IONIC UNICORN', 'IRENES RAINBOW', 'IRENES REMEDY', 'IRENES RESOLVE', 'JACKSON BAY', 'JADRANA', 'JALMA TOPIC', 'JEMINA', 'JETT', 'JETTE', 'JI AN GONG 358', 'JIAN GONG', 'JIN HUI 338', 'JOHANNES MAERSK', 'JOLLY EXPRESS', 'JONATHAN P', 'JONATHAN SWIFT', 'JORK', 'JORK RULER', 'JPO GEMINI', 'JPO PISCES', 'JUTIUS-S', 'K4 2404', 'K42352', 'K42405', 'KARLA A', 'KATHARINA SCHEPERS', 'KMARIN ATLANTICA', 'KOI', 'KOTA  SEJATI', 'KOTA DAHLIA', 'KOTA HANDAL', 'KOTA KAMIL', 'KOTA LANGSAR', 'KOTA LAYANG', 'KOTA LEGIT', 'KOTA LOCENG', 'KOTA LUKIS', 'KOTA LUMBA', 'KOTA MACHAN', 'KOTA MANIS', 'KOTA RAKAN', 'KOTA RAKYAT', 'KOTA SABAS', 'KOTA SAHABAT', 'KOTA SALAM', 'KOTA SATRIA', 'KOTA SEGAR', 'KOTA SEJARAH', 'KOTA SEJATI', 'KOTA SELAMAT', 'KOTA SEMPENA', 'KOTA SETIA', 'KOTA SINGA', 'KOTA SURIA', 'KOTAD SEGAR', 'KRISTINA', 'KYOTO  EXPRESS', 'KYOTO EXPRESS', 'LADY OF LUCK', 'LAETITIA V', 'LAKE  KIVU', 'LAKE  SUPERIOR', 'LAKE KIVU', 'LAKE KIWU', 'LAKE SUPERIOR', 'LANA', 'LARS MAERSK', 'LAURA MAERSK', 'LAUST MAERSK', 'LETO', 'LEXA MAERSK', 'LEYLA KALKAVAN', 'LIBERTAS H', 'LICA MAERSK', 'LINDA', 'LION', 'LISA', 'LIVERPOOL EXPRESS', 'LIVORNO EXPRESS', 'LODUR', 'LOTUS A', 'LUCIE SCHULTE', 'LYDIA', 'LYME BAY', 'M.V.SFL KATE', 'MACAO', 'MADISON MAERSK', 'MADRID MAERSK', 'MAERSK ABERDEEN', 'MAERSK AMAZON', 'MAERSK BINTULU', 'MAERSK CABO VERDE', 'MAERSK CAMBRIDGE', 'MAERSK CAPE COAST', 'MAERSK CAPE GUATEMALA', 'MAERSK CHESAPEAKE', 'MAERSK CHICAGO', 'MAERSK COLUMBUS', 'MAERSK CONAKRY', 'MAERSK CONGO', 'MAERSK COPENHAGEN', 'MAERSK COTONOU', 'MAERSK CUNENE', 'MAERSK DAKAR', 'MAERSK DENVER', 'MAERSK DURBAN', 'MAERSK EDMONTON', 'MAERSK ELBA', 'MAERSK ESSEX', 'MAERSK GARONNE', 'MAERSK GENOA', 'MAERSK GIBRALTAR', 'MAERSK GUATEMALA', 'MAERSK GUAYAQUIL', 'MAERSK HAI PHONG', 'MAERSK HORSBURGH', 'MAERSK IDAHO', 'MAERSK INNOSHIMA', 'MAERSK IZMIR', 'MAERSK JAIPUR', 'MAERSK KARLSKRONA', 'MAERSK KENSINGTON', 'MAERSK KENTUCKY', 'MAERSK KWANGYANG', 'MAERSK LABERINTO', 'MAERSK LAUNCESTON', 'MAERSK LEON', 'MAERSK LINS', 'MAERSK LOTA', 'MAERSK LUZ', 'MAERSK NAIROBI', 'MAERSK NIJMEGEN', 'MAERSK NUBA', 'MAERSK PALERMO', 'MAERSK PENANG', 'MAERSK PUELO', 'MAERSK STRALSUND', 'MAERSK STRLSUND', 'MAERSK VALPARAISO', 'MAERSK VIGO', 'MAERSK YAMUNA', 'MAERSK YORKTOWN', 'MAESK MONTANA', 'MAJESTIC', 'MAJESTIC MAERSK', 'MANCHESTER MAERSK', 'MANDO', 'MANILA MAERSK', 'MARCHEN MAERSK', 'MAREN', 'MARFRET GUYANE', 'MARGRETHE MAERSK', 'MARID MAERSK', 'MARIE MAERSK', 'MARSTAL MAERSK', 'MARTHA A', 'MARTHA SCHULTE', 'MARTINIQUE', 'MARY', 'MATHILDE MAERSK', 'MATZ MAERSK', 'MCC QINGDAO', 'MCS VANDYA', 'MEHUIN', 'MENDELSSOHN', 'MERATUS JIMBARAN', 'MERETE MAERSK', 'MERKUR  FJORD', 'MERKUR FJORD', 'MERKUR FJORG', 'MERKUR HORIZON', 'MERSK SELETAR', 'METHONI', 'MH PEGASUS', 'MH PERSEUS', 'MICHIGAN', 'MILAN TRADER', 'MIMI SCHULTE', 'MIMMI SCHULTE', 'MIMMI SCULTE', 'MIMMI SHULTE', 'MIRADOR EXPRESS', 'MIRROR', 'MISTRAL', 'MOGENS MAERSK', 'MOL EMISSARY', 'MOL PROFICIENCY', 'MOL TREASURE', 'MONA LISA', 'MONEMVASIA', 'MONTE AZUL', 'MONTE CERVANTES', 'MONTE OLIVIA', 'MORAGA', 'MORNING CAPO', 'MORNING COMPOSER', 'MORTEN MAERSK', 'MOSCOW MAERSK', 'MOVEON', 'MP THE LAW', 'MSC   RENEE', 'MSC  ATLANTIC III', 'MSC  AUGUSTA', 'MSC  AZOV', 'MSC  FEDERICA', 'MSC  INDIA', 'MSC  MASCARET', 'MSC ABIDJAN', 'MSC ABY', 'MSC ADRIANA', 'MSC ADRIANA II', 'MSC AGAMEMNON', 'MSC ALDEBRAN III', 'MSC ALEXA', 'MSC ALEXANDRA', 'MSC ALICANTE', 'MSC ALINA', 'MSC ALIX 3', 'MSC ALIYA', 'MSC ALYSSA', 'MSC AMANDA F', 'MSC AMY', 'MSC ANAHITA', 'MSC ANCONA III', 'MSC ANGELA', 'MSC ANIELLO', 'MSC ANIIELLO', 'MSC ANUSHA III', 'MSC ANYA', 'MSC APOLLINE', 'MSC ARIA', 'MSC ARIANE', 'MSC ARICA', 'MSC ATLANTIC III', 'MSC AUGUSTA', 'MSC AURORA', 'MSC AZOV', 'MSC BARBADOS', 'MSC BEATRICE', 'MSC BEIJING', 'MSC BERANGERE', 'MSC BERYL', 'MSC BETTINA', 'MSC BHAVYA', 'MSC BIANCA', 'MSC BRANKA', 'MSC BRIDGE', 'MSC BUSAN', 'MSC CAMILLE', 'MSC CANBERRA', 'MSC CANDICE', 'MSC CAPELLA', 'MSC CARMEN', 'MSC CAROLINA', 'MSC CASSANDRE', 'MSC CATERINA', 'MSC CHARLESTON', 'MSC CHLOE', 'MSC CORUNA', 'MSC CRISTINA', 'MSC DANIELA', 'MSC DANIT', 'MSC DARDANELLES', 'MSC DARIA', 'MSC DENMARK', 'MSC DENMARK VI', 'MSC DESIREE', 'MSC DIANA', 'MSC DILETTA', 'MSC DON GIOVANNI', 'MSC DON GLOVANNI', 'MSC DYMPHNA', 'MSC ELIANE', 'MSC ELODIE', 'MSC ENGLAND', 'MSC ERICA', 'MSC ESTHI', 'MSC EUGENIA', 'MSC EVA', 'MSC FAITH', 'MSC FATMA', 'MSC FIAMMETTA', 'MSC FIE', 'MSC FLAMINIA', 'MSC FLAVIA', 'MSC FLORIANA', 'MSC FRANCESCA', 'MSC GEORGIA II', 'MSC GIULIA', 'MSC GRENADA', 'MSC HAMBURG', 'MSC HANNAH', 'MSC HEIDI', 'MSC HIMANSHI', 'MSC IMMA III', 'MSC INDIA', 'MSC INES', 'MSC ISABELLA', 'MSC ISHYKA', 'MSC IVANA', 'MSC JANIS', 'MSC JORDAN', 'MSC JOSSELINE', 'MSC JUDITH', 'MSC JULIE', 'MSC KANOKO', 'MSC KATRINA', 'MSC KATYANI', 'MSC KATYAYNI', 'MSC KRISTAL', 'MSC KRYSTAL', 'MSC KRYSTAL V', 'MSC KYMEA', 'MSC LA SPEZIA', 'MSC LEANNE', 'MSC LETZIA', 'MSC LIPSIA III', 'MSC LORETTA', 'MSC LUCIANA', 'MSC MADELEINE', 'MSC MADRID', 'MSC MAEVA', 'MSC MALENA', 'MSC MANDY', 'MSC MANYA', 'MSC MARA', 'MSC MARGARITA', 'MSC MARIA ELENA', 'MSC MARIA SAVERIA', 'MSC MARIANNA', 'MSC MARINA', 'MSC MARTA', 'MSC MASCARET', 'MSC MAUREEN', 'MSC MEDITERRANEAN', 'MSC MELATILDE', 'MSC MELISSA', 'MSC MIA SUMMER', 'MSC MIRJA', 'MSC MONTEREY', 'MSC NADRIELY', 'MSC NAISHA III', 'MSC NEDERLAND', 'MSC NEDERLAND III', 'MSC NEW HAVEN', 'MSC NEW YORK', 'MSC NOA', 'MSC NURIA', 'MSC ORIANE', 'MSC ORION', 'MSC PALAK', 'MSC PALOMA', 'MSC PEGASUS', 'MSC PILAR', 'MSC PINA', 'MSC QINGDAO', 'MSC RACHELE V', 'MSC RAFAELA', 'MSC RAPALLO', 'MSC RAVENNA', 'MSC RAYSHMI', 'MSC RENEE', 'MSC RIFAYA', 'MSC RIKKU', 'MSC RITA', 'MSC ROSA M', 'MSC ROSAM', 'MSC ROSARIA', 'MSC SAGITTA III', 'MSC SAMANTHA', 'MSC SANTHYA', 'MSC SANTYA', 'MSC SARISKA', 'MSC SARISKA V', 'MSC SENA', 'MSC SHANNON', 'MSC SHAULA', 'MSC SINDY', 'MSC SINES R', 'MSC SIXIN', 'MSC SOFIA CELESTE', 'MSC SOFIA PAZ', 'MSC SONIA', 'MSC STELLA', 'MSC SUEZ', 'MSC SUSANNA', 'MSC TAMPA', 'MSC TARANTO', 'MSC TAVVISHI', 'MSC TIANPING', 'MSC TOMOKO', 'MSC TRIESTE V', 'MSC UNITED VIII', 'MSC VALERIA', 'MSC VANDYA', 'MSC VICTORIA', 'MSC VIDHI', 'MSC VILDA X', 'MSC VIRGO', 'MSC WASHINGTON', 'MSC YOSHEEN', 'MSC YUKTA X', 'MSC YURIDA III', 'MSCALYSSA', 'MUMBAI MAERSK', 'MUNICH MAERSK', 'MURCIA MAERSK', 'MV DANSHIP BULKER', 'MV SFL KAT', 'MV VERONICA DP', 'MYNY', 'NAVIOS AZURE', 'NAVIOS DEDICATION', 'NAVIOS DESTINY', 'NAVIOS DEVOTION', 'NAVIOS DOMINO', 'NAVIOS MAGNOLIA', 'NAVIOS NERINE', 'NAVIOS SPRING', 'NAVIOS VERMILION', 'NEUBURG', 'NEUENFELDE', 'NEUENFLDE', 'NEW YORK EXPRESS', 'NEWYORKER', 'NEXOE MAERSK', 'NICOLAS DELMAS', 'NIKOLAS', 'NILEDUTCH BREDA', 'NILEDUTCH LION', 'NILEDUTCH REDA', 'NILEDUTUCH BREDA', 'NORA MAERSK', 'NORDAMSTEL', 'NORDAUTUMN', 'NORDIC ITALIA', 'NORDIC MACAU', 'NORDPUMA', 'NORO', 'NORTH PRELUDE', 'NORTHERN DECENCY', 'NORTHERN DEFENDER', 'NORTHERN DEPENDANT', 'NORTHERN GENERAL', 'NORTHERN POWER', 'NORTHERN PREFLUDE', 'NORTHERN PRELUDE', 'NORTHERN PRIORITY', 'NRTHERN POWER', 'NYK  VESTA', 'NYK ISABEL', 'OAKLAND', 'OBSERVATOR', 'ODYSSEUS', 'OKEE ALICIA', 'OKEE CUNO', 'OLAND', 'OLIVIA', 'OLIVIA I', 'ONE FALCON', 'ONE HENRY HUDSON', 'ONE MACKINAC', 'ONE TRADITION', 'OOCL CALIFORNIA', 'OOCL PANAMA', 'OPS HAMBURG', 'OSAKA EXPRESS', 'PANTHER', 'PELION', 'PERSEUS', 'PERSEUS   LIBERTY', 'PINARA', 'POHORJE', 'PORTO GERMENO', 'PORTSMOUTH', 'PRAGUE EXPRESS', 'PRINCESS MARIA', 'QI HE 11', 'QIHE', 'RAINER D', 'RANGER', 'RCC EUROPE', 'RDO FAVOUR', 'RED SAKURA', 'RENA P', 'REPUBBLICA ARGENTINA', 'REPUBBLICA DEL BASILE', 'REPUBBLICA DEL BRASIL', 'REPUBBLICA DEL BRASILE', 'REPUBLICA ARGENTINA', 'REPUBLICA DEL BRASILE', 'RHINE MAERSK', 'RHL  CONSTANTIA', 'RHL CONCORDIA', 'RHL CONSCIENTIA', 'RHL CONSTANTIA', 'RIJNBORG', 'RIO CADIZ', 'RIO CHARLESTON', 'ROME EXPRESS', 'ROSA', 'S SANTIAGO', 'SAFMARINE CAMEROUN', 'SAFMARINE NAKURU', 'SAFMARINE NILE', 'SAFMARINE NOMAZWE', 'SAGAMORE', 'SAMSKIP HOFFELL', 'SAN CLEMENTE', 'SAN FELIX', 'SAN NICOLAS MAERSK', 'SAN VICENTE', 'SANTA  RITA', 'SANTA CLARA', 'SANTA RITA', 'SANTA VANESSA', 'SASKIA A', 'SATIE', 'SEA PATRIS', 'SEABREEZE', 'SEADREAM', 'SEAGO FELIXSTOWE', 'SEAGO ISTANBUL', 'SEAMAX STAMFORD', 'SEAPAN  SANTOS', 'SEASLAND ILLINOIS', 'SEASPAN  LONCOMILLA', 'SEASPAN CHIWAN', 'SEASPAN DUBAI', 'SEASPAN LOGA', 'SEASPAN LONCOMILLA', 'SEASPAN OSPREY', 'SEASPAN RIO DE JANEIRO', 'SEASPAN SAIGON', 'SEASPANRIODEJANEIRO', 'SHANG YUAN MEN', 'SHIJING', 'SIEM PLATO', 'SILVER MOON', 'SILVER SOUL', 'SILVER SUN', 'SIMA GENESIS', 'SINE A', 'SM KAVERI', 'SM MANALI', 'SOFIA EXPRESS', 'SOL PROGRESS', 'SONGA BONN', 'SOUNION TRADER', 'SPARTEL TRADER', 'SPIL CITRA', 'STADT DRESDEN', 'STAR  PRIDE', 'STAR  PRIMA', 'STAR CARE', 'STAR COURAGE', 'STAR FIRST', 'STAR LEADER', 'STAR PEGASUS', 'STAR PRIDE', 'STAR PRIMA', 'STAR STANDARD', 'STAR TRUST', 'STEEN', 'STEFAN SIBUM', 'STELLA ISLAND', 'STRALSUND', 'SUDEROOG', 'SUNNY PHOENIX', 'SUSAN', 'SYDNEY EXPRESS', 'SYNERGY ANTWERP', 'SYNERGY OAKLAND', 'TANGIER EXPRESS', 'TANJA', 'TBC PROGRESS', 'TENO', 'TEOMAN A', 'TIAN XIANG HE', 'TIHAMA', 'TIM-S', 'TINA I', 'TOCONAO', 'TOKYO SPIRIT', 'TOLTEN', 'TONG DA', 'TONG HAI 999', 'TONSBERG', 'TRAIGUEN', 'TRAIN', 'TRIESTE TRADER', 'TS QINGDAO', 'TSINGTAO EXPRESS', 'UASC ZAMZAM', 'ULANGA', 'ULSAN', 'UMM SALAL', 'URUGUAY', 'VAGA MAERSK', 'VALDIVIA', 'VALENCIA EXPRESS', 'VANCOUVER STAR', 'VENTA MAERSK', 'VENTO DI BORA', 'VENTO DI MAESTRALE', 'VICTORIA L', 'VILNIA MAERSK', 'VIRGO', 'VISTULA MAERSK', 'VIVIEN A', 'VOLGA MAERSK', 'VORONEZH', 'VULPECULA', 'VUOKSI MAERSK', 'W KAMPALA', 'W KITHIRA', 'WADI ALRAYAN', 'WAN HAI 511', 'WANTONGDA 99', 'WARNOW MATE', 'WEC CORNEILLE', 'WEC MAJORELLE', 'WIDE CHARLIE', 'WIDE JULIET', 'WIELAND', 'WIKING', 'WILHELMINE', 'WINDERMERE', 'WIRKING', 'WKING', 'WU JIA ZUI JI 19', 'WYBELSUM', 'XIAMEN', 'XIN CANG ZHOU', 'XIN MING ZHOU 20', 'XIN MING ZHOU22', 'XIN QIN ZHOU', 'XIN YAN TAI', 'XIN YONG CHANG 17', 'XINYONGCHANG8', 'X-PRESS COTOPAXI', 'X-PRESS GUERNSEY', 'X-PRESS KHYBER', 'X-PRESS MONTE BIANCO', 'YANGZE 8', 'YI FENG 888', 'YIGITCAN A', 'YM INVENTIVE', 'YM WINNER', 'YOUNGYUE11', 'YUE AN YUN 12', 'YUE JIANG1', 'ZE XIN JUN JIE', 'ZHEN DONG', 'ZHEN DONG 588', 'ZHI HANG 518', 'ZHONG DA 13', 'ZHONG GU JIANG SU', 'ZIM BALTIMORE', 'ZIM DALIAN', 'ZIM ROTTERDAM', 'ZOI']

COD_BANQUE = ['ACB1', 'BAT1', 'BBG1', 'BDA', 'BDA1', 'BDU1', 'BGFI', 'BIC1', 'BNI1', 'BOA1', 'BPCI', 
              'BRM1', 'BSIC', 'C1188', 'CCP1', 'CIB1', 'CORB', 'DBCI', 'DISP', 'ECO1', 'GTB1', 'MAN1', 
              'NSIA', 'ORA1', 'SBCI', 'SCB1', 'SGB1', 'SGCI', 'SIB1', 'UBA1', 'VEBA'
              ]

#model = joblib.load("C:/Users/HP 820 G3/Desktop/DOUANES CI/ANALYSE CONTENTIEUX/models/fraud_detection_model.pkl")
model = joblib.load("fraud_detection_model.pkl")


features_imports = ['CODE_DECLARANT', 'CODE_OPERATEUR', 'PROVENANCE', 'CODE_NATURE_COLIS',
                    'CODE_PORT_CHARG', 'IDEN_MOY_TRANSP_ARRIVE', 'COD_BANQUE']

class_names = ['EXC', 'FDE', 'FDV', 'NON_FRAUDE']

app = FastAPI(title="Fraud Detection API")

# CORS (frontend React)
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"], # Allow all origins for development
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# --------- Mock metadata (Ã  remplacer par DB ou fichier) ----------
METADATA = {
    "CODE_DECLARANT": CODE_DECLARANT,
    "CODE_OPERATEUR": CODE_OPERATEUR,
    "PROVENANCE": PROVENANCE,
    "CODE_NATURE_COLIS": CODE_NATURE_COLIS,
    "CODE_PORT_CHARG": CODE_PORT_CHARG,
    "IDEN_MOY_TRANSP_ARRIVE": IDEN_MOY_TRANSP_ARRIVE,
    "COD_BANQUE": COD_BANQUE
}

# --------- Input schema ----------
class PredictionInput(BaseModel):
    CODE_DECLARANT: str
    CODE_OPERATEUR: str
    PROVENANCE: str
    CODE_NATURE_COLIS: str
    CODE_PORT_CHARG: str
    IDEN_MOY_TRANSP_ARRIVE: str
    COD_BANQUE: str

# --------- Ouput schema ----------
class PredictionResponse(BaseModel):
    prediction: str
    probability: float

# --------- Routes ----------
@app.get("/")
def read_root():
    return {"message": "Fraud Detection API is running."}

#@app.get("/metadata")
#async def get_metadata():
    #return METADATA

@app.post("/predict")
def predict(data: PredictionInput):

    features = pd.DataFrame(list([data.CODE_DECLARANT, 
                                 data.CODE_OPERATEUR, 
                                 data.PROVENANCE,
                                 data.CODE_NATURE_COLIS, 
                                 data.CODE_PORT_CHARG, 
                                 data.IDEN_MOY_TRANSP_ARRIVE, 
                                 data.COD_BANQUE]), 
                            index=features_imports).T
    
    pre_prediction = model.predict(features)
    prediction_class = class_names[int(pre_prediction[0])]
    probability = round(max(model.predict_proba(features)[0]), 2)
    prediction = prediction_class if (probability > 0.7) & (prediction_class in ['EXC', 'FDE', 'FDV']) else "NON_FRAUDE"

    return {
        "prediction": prediction,
        "probability": probability
    }
